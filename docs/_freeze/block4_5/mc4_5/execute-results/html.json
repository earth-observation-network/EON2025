{
  "hash": "9dae8311e30bc584c30ff35fc31a3e82",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Microclimate â€” Per-Timestamp Report\"\nformat:\n  html:\n    toc: true\n    number-sections: false\n  # pdf:\n  #   toc: true\n  #   number-sections: true\n  #   geometry:\n  #     - margin=2cm\nexecute:\n  echo: false\n  warning: false\n  message: false\n---\n\n::: {.cell}\n\n:::\n\n\n\n# 1. Overview\n\n* **Timestamp:** 2023-08-29 09:00\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Item                 |Value                                   |\n|:--------------------|:---------------------------------------|\n|R* (base)            |35                                      |\n|R* (extras)          |35                                      |\n|Best method (base)   |IDW (RMSE=1.116, MAE=0.847, Bias=0.106) |\n|Best method (extras) |IDW (RMSE=1.116, MAE=0.847, Bias=0.106) |\n\n\n:::\n:::\n\n\n\n# 2. Scales from variogram\n\n## ðŸ”§ Chosen radii $R$ (micro/local)\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Run    | R_micro| R_local|\n|:------|-------:|-------:|\n|Base   |      19|      57|\n|Extras |      19|      57|\n\n\n:::\n:::\n\n\n\n---\n\n## ðŸ”§ Cross-validation block size\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Run    | CV block size (m)|\n|:------|-----------------:|\n|Base   |                57|\n|Extras |                57|\n\n\n:::\n:::\n\n\n\n---\n\n## ðŸ”§ Prozess-Skala $\\sigma_{proc}$ & Mismatch-Penalty $g(R/L)$\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Quantity         | Value|\n|:----------------|-----:|\n|Ïƒ_inst (assumed) |    NA|\n\n\n:::\n\n::: {.cell-output-display}\n\n\n|Quantity                | Value|\n|:-----------------------|-----:|\n|Ïƒ_proc (from variogram) | 1.282|\n|R / L95                 | 0.616|\n|g(R/L)                  | 0.120|\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Metric      |     Base|   Extras|\n|:-----------|--------:|--------:|\n|L50 (model) | 13.15600| 13.15600|\n|L95 (model) | 56.85928| 56.85928|\n|L50 (emp)   | 19.99126| 19.99126|\n|L95 (emp)   | 29.62442| 29.62442|\n\n\n:::\n:::\n\n\n\n# 3. Tuned drift radius \\$R^\\*\\$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Model           | R* (m)|\n|:---------------|------:|\n|Base predictors |     35|\n|With extras     |     35|\n\n\n:::\n:::\n\n\n\n## U-curve (block-CV)\n\n**Base predictors**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![U-curve (base) â€” vertical line marks R* if found.](interpolated/fig/u_curve_2023-08-29-09-00.png){width=100%}\n:::\n:::\n\n\n\n**With extra predictors**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![U-curve (with extras).](interpolated/fig/u_curve_extras_2023-08-29-09-00.png){width=100%}\n:::\n:::\n\n\n\n# 4. Benchmark at \\$R^\\*\\$\n\n**Base predictors**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|   |method  |  RMSE|   MAE|   Bias| R_star| block_size|\n|:--|:-------|-----:|-----:|------:|------:|----------:|\n|5  |IDW     | 1.116| 0.847|  0.106| 56.859|     56.859|\n|2  |RF      | 1.245| 0.980|  0.094| 56.859|     56.859|\n|6  |Voronoi | 1.257| 0.873| -0.053| 56.859|     56.859|\n|3  |Trend   | 1.326| 1.094|  0.217| 56.859|     56.859|\n|4  |GAM     | 1.326| 1.094|  0.217| 56.859|     56.859|\n|1  |OK      | 1.713| 1.475| -0.219| 56.859|     56.859|\n|7  |KED     | 1.840| 1.617| -0.292| 56.859|     56.859|\n\n\n:::\n:::\n\n\n\n**Figure (base)**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Benchmark (base). Lower RMSE is better.](interpolated/fig/benchmark_2023-08-29-09-00.png){width=100%}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|   |method  |  RMSE|   MAE|   Bias| R_star| block_size|\n|:--|:-------|-----:|-----:|------:|------:|----------:|\n|5  |IDW     | 1.116| 0.847|  0.106| 56.859|     56.859|\n|2  |RF      | 1.229| 0.969|  0.094| 56.859|     56.859|\n|6  |Voronoi | 1.257| 0.873| -0.053| 56.859|     56.859|\n|3  |Trend   | 1.326| 1.094|  0.217| 56.859|     56.859|\n|4  |GAM     | 1.326| 1.094|  0.217| 56.859|     56.859|\n|1  |OK      | 1.713| 1.475| -0.219| 56.859|     56.859|\n|7  |KED     | 1.840| 1.617| -0.292| 56.859|     56.859|\n\n\n:::\n:::\n\n\n\n**Figure (extras)**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Benchmark (with extras).](interpolated/fig/benchmark_extras_2023-08-29-09-00.png){width=100%}\n:::\n:::\n\n\n\n# 5. Error budget\n**base predictors**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|component       |formula             | value| squared|\n|:---------------|:-------------------|-----:|-------:|\n|Bias            |Bias^2              | 0.238|   0.057|\n|Sensor (Ïƒ_inst) |Ïƒ_inst^2            | 0.500|   0.250|\n|Scale mismatch  |(Î± Ïƒ_proc g(R/L))^2 | 0.092|   0.009|\n|Model rest      |Ïƒ_model^2           | 1.629|   2.655|\n|Total (RMSE)    |â€”                   | 1.723|   2.970|\n\n\n:::\n:::\n\n\n\n**With extra predictors**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|component       |formula             | value| squared|\n|:---------------|:-------------------|-----:|-------:|\n|Bias            |Bias^2              | 0.238|   0.057|\n|Sensor (Ïƒ_inst) |Ïƒ_inst^2            | 0.500|   0.250|\n|Scale mismatch  |(Î± Ïƒ_proc g(R/L))^2 | 0.092|   0.009|\n|Model rest      |Ïƒ_model^2           | 1.629|   2.655|\n|Total (RMSE)    |â€”                   | 1.723|   2.970|\n\n\n:::\n:::\n\n\n\n# 6. Multi-panel preview\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Per-timestep KED previews; shared color scale. Dots = stations; red = plot boundary.](interpolated/fig/timeseries_panel_grid.png){width=100%}\n:::\n:::\n\n\n\n# 7. Files written\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Description        |Path                                                                                                 | Exists |\n|:------------------|:----------------------------------------------------------------------------------------------------|:------:|\n|U-curve (base)     |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/u_curve_2023-08-29-09-00.png          |  TRUE  |\n|U-curve (extras)   |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/u_curve_extras_2023-08-29-09-00.png   |  TRUE  |\n|Benchmark (base)   |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/benchmark_2023-08-29-09-00.png        |  TRUE  |\n|Benchmark (extras) |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/benchmark_extras_2023-08-29-09-00.png |  TRUE  |\n|Panel (PNG)        |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/timeseries_panel_grid.png             |  TRUE  |\n|Panel (PDF)        |/home/creu/edu/gisma-courses/EON2025/block4_5/interpolated/fig/timeseries_panel_grid.pdf             |  TRUE  |\n\n\n:::\n:::\n\n\n\n# Leitidee â€” Von der Prozessâ€‘Skala zur Modellentscheidung\n\nRÃ¤umliche Interpolation ist dann fachlich belastbar, wenn **Prozess**, **Skala** und **Modellannahmen** zueinander passen. Der Weg dorthin ist nicht â€žAlgorithmus zuerstâ€œ, sondern:\n\n1) **Skala verstehen:** Wir schÃ¤tzen aus den Daten die **rÃ¤umliche Korrelation** des Prozesses. Das (empirische/angepasste) Variogramm liefert praktische KorrelationslÃ¤ngen \\(L_{50}, L_{95}\\) und die Prozessâ€‘Streuung \\(\\sigma_{\\text{proc}}\\). Diese GrÃ¶ÃŸen sind keine hÃ¼bschen Nebenprodukte, sondern **Leitplanken** fÃ¼r alle weiteren Entscheidungen.\n\n2) **Drift skalenkohÃ¤rent machen:** Kovariaten (z.â€¯B. DEM) werden auf die Prozessâ€‘Skala **geglÃ¤ttet**. Kleine Skalen brauchen kurze Radien (\\(R_{\\text{micro}}\\)), grÃ¶ÃŸere Skalen lÃ¤ngere (\\(R_{\\text{local}}\\)). Ziel ist ein Driftfeld, das die **gleiche Skala** wie der Prozess trÃ¤gt â€“ weder verrauscht (zu klein) noch Ã¼berglÃ¤ttet (zu groÃŸ).\n\n3) **Radius feinabstimmen (Uâ€‘Kurve):** Welcher Radius \\(R\\) minimiert die **geblockte** Vorhersagefehlerâ€‘Metrik? Zu kleine \\(R\\) Ã¼berlassen dem Modell Rauschen (Varianzfehler), zu groÃŸe \\(R\\) erzeugen systematischen Fehler (Bias). Die CVâ€‘Fehlerkurve wird deshalb meist **Uâ€‘fÃ¶rmig** â€“ ihr Minimum definiert \\(R^*\\).\n\n4) **Valide Bewertung (Blockâ€‘CV):** Folds werden **rÃ¤umlich** gebildet â€“ mit BlockgrÃ¶ÃŸen in der GrÃ¶ÃŸenordnung von \\(L_{95}\\) oder \\(R^*\\). So vermeiden wir rÃ¤umliches **Leck** (Train/Testâ€‘Nachbarschaften sind sonst zu Ã¤hnlich) und erhalten realistischere RMSE/MAE/Bias.\n\n5) **Fehler budgetieren:** Der beobachtete Fehler lÃ¤sst sich heuristisch in **Messrauschen** (\\(\\sigma_{\\text{inst}}\\)), **Skalenâ€‘Mismatch** (Faktor \\(g(R/L)\\)) und **Modellâ€‘Rest** zerlegen. Nur wenn Driftâ€‘Skala, CVâ€‘Blockierung und Benchmarking **kohÃ¤rent** sind, ist diese Aufteilung interpretierbar.\n\nDas ist die Klammer: **Skala â†’ Drift â†’ Tuning â†’ Bewertung â†’ Budget.**\n\n---\n\n## L50 / L95 â€” praktische KorrelationslÃ¤ngen\n**Idee.** Wie schnell verliert der Prozess Ã„hnlichkeit mit Entfernung?  \n**Semivarianz** eines (intrinsisch) stationÃ¤ren Prozesses \\(Z(\\mathbf{s})\\):\n\\[\n\\gamma(h) = \\tfrac{1}{2}\\,\\operatorname{Var}[Z(\\mathbf{s})-Z(\\mathbf{s}+\\mathbf{h})].\n\\]\nMit Nugget \\(C_0\\) und strukturellem Anteil (Partial Sill) \\(C\\) gilt bei einem angepassten Variogramm\n\\[\n\\gamma(h) = C_0 + C\\,\\bigl(1-\\rho(h)\\bigr),\n\\]\nwobei \\(\\rho(h)\\) die modellierte Autokorrelation ist. Die **praktische KorrelationslÃ¤nge** \\(L_p\\) ist der kleinste Abstand, bei dem \\(p\\)-Anteil des strukturellen Sills erreicht wird:\n\\[\nL_p = \\inf\\{h:\\; \\gamma(h) \\ge C_0 + p\\,C\\},\\qquad p\\in(0,1).\n\\]\n**SpezialfÃ¤lle:** \\(L_{50}\\) (mittlere Skala), \\(L_{95}\\) (konservative Reichweite).\n\n**Intuition.** \\(L_{50}\\) markiert die â€žhalbeâ€œ Strukturvarianz; \\(L_{95}\\) steht dafÃ¼r, dass fast die ganze strukturierte Varianz erreicht ist. Praktisch: \\(L_{95}\\) ist ein robuster Anker fÃ¼r BlockgrÃ¶ÃŸen und GlÃ¤ttungsradien.\n\n---\n\n## \\(R\\) (micro/local) â€” gewÃ¤hlte GlÃ¤ttungsradien\n**Idee.** Kovariaten/Drift (z.â€¯B. DEM) als **tiefpassgefilterte** Felder auf Prozessâ€‘Skala bringen.\n\n**Daumenregel.**\n\\[\nR_{\\text{micro}} \\approx L_{50}, \\qquad R_{\\text{local}} \\approx L_{95}.\n\\]\n**Konsequenz.** \\(R\\ll L\\) â†’ UnterglÃ¤ttung (rauschiges Driftfeld); \\(R\\gg L\\) â†’ ÃœberglÃ¤ttung (Bias). Beides verschlechtert Vorhersagen.\n\n---\n\n## \\(R^*\\) â€” getunter Driftâ€‘Radius Ã¼ber Uâ€‘Kurve\n**Definition.**\n\\[\nR^* = \\arg\\min_{R\\in\\mathcal{R}}\\; \\operatorname{RMSE}_{\\text{blockâ€‘CV}}(R).\n\\]\n**Warum Uâ€‘fÃ¶rmig?** Kleine \\(R\\): hohe Varianz (Noise). GroÃŸe \\(R\\): hoher Bias (ÃœberglÃ¤ttung). Dazwischen liegt ein Minimum.  \n**Praxis.** Tuning **geblockt** (nicht punktweise) durchfÃ¼hren, sonst wird die Kurve kÃ¼nstlich zu optimistisch.\n\n---\n\n## Block size â€” rÃ¤umliche Kreuzvalidierung\n**Ziel.** RÃ¤umliches **Leck** vermeiden: Trainingsâ€‘ und Testpunkte dÃ¼rfen nicht zu nah sein.\n\n**Wahl.** BlockkantenlÃ¤nge in der GrÃ¶ÃŸenordnung von \\(L_{95}\\) oder \\(R^*\\).  \n**Hinweis.** Bei Anisotropie sind **rechteckige/gerichtete** BlÃ¶cke sinnvoll (grÃ¶ÃŸer in Richtung langsamer Dekommission der Korrelation).\n\n---\n\n## RMSE / MAE / Bias â€” FehlergrÃ¶ÃŸen (geblockte CV)\nFÃ¼r Beobachtungen \\(y_i\\) und Vorhersagen \\(\\hat y_i\\):\n\\[\n\\text{Bias} = \\frac{1}{n}\\sum_i (\\hat y_i - y_i),\\quad\n\\text{MAE} = \\frac{1}{n}\\sum_i |\\hat y_i - y_i|,\\quad\n\\text{RMSE} = \\sqrt{\\frac{1}{n}\\sum_i (\\hat y_i - y_i)^2}.\n\\]\n**Interpretation.** RMSE betont AusreiÃŸer, MAE ist robust(er), Bias zeigt Vorzeichenâ€‘Fehler. AussagekrÃ¤ftig nur bei **geblockter** CV.\n\n---\n\n## \\(\\sigma_{\\text{proc}}\\) â€” Prozessâ€‘Standardabweichung\n**Idee.** Streuung der **strukturierten** Komponente (ohne Nugget/Instrumentenrauschen) aus dem Variogramm.\n\n**Eine Komponente.** Wenn der strukturelle Sill \\(C\\) ist:\n\\[\n\\sigma_{\\text{proc}} = \\sqrt{C}.\n\\]\n**Mehrere Komponenten.** Bei z.â€¯B. SphÃ¤risch + MatÃ©rn mit Partial Sills \\(C_j\\):\n\\[\n\\sigma_{\\text{proc}} = \\sqrt{\\sum_j C_j}.\n\\]\n**Nutzen.** MaÃŸ fÃ¼r Prozessâ€‘Amplitude; dient im Fehlerbudget als Anker fÃ¼r â€žerklÃ¤rbareâ€œ Varianz.\n\n---\n\n## \\(\\sigma_{\\text{inst}}\\) â€” Instrumentenrauschen (angenommen)\n**Idee.** MessgerÃ¤te haben ein (nahezu) weiÃŸes, additives Rauschen.\n\n**Rolle im Budget.** In einer additiven Zerlegung der Fehlerenergie:\n\\[\n\\operatorname{RMSE}^2 \\;\\approx\\; \\underbrace{\\sigma_{\\text{inst}}^2}_{\\text{Messrauschen}}\n\\; +\\; \\underbrace{\\sigma_{\\text{scale}}^2}_{\\text{Skalenâ€‘Mismatch}}\n\\; +\\; \\underbrace{\\sigma_{\\text{model}}^2}_{\\text{Modellâ€‘Rest}}.\n\\]\n**Praxis.** \\(\\sigma_{\\text{inst}}\\) wird projektspezifisch gesetzt (z.â€¯B. 0.5 K) und im Report transparent ausgewiesen.\n\n---\n\n## \\(g(R/L)\\) â€” Strafterm fÃ¼r Skalenâ€‘Mismatch\n**Ziel.** MissverhÃ¤ltnis zwischen GlÃ¤ttungsradius \\(R\\) und Prozessâ€‘Skala \\(L\\) symmetrisch quantifizieren.\n\n**Definition.**\n\\[\n g\\!\\left(\\tfrac{R}{L}\\right) = \\tfrac{1}{2}\\!\\left(\\tfrac{R}{L}+\\tfrac{L}{R}\\right) - 1.\n\\]\n**Eigenschaften.** \\(g(x)\\ge 0\\), Minimum bei \\(x=1\\), Symmetrie \\(g(x)=g(1/x)\\); streng konvex auf \\(x>0\\).  \n**Lesart.** \\(R/L=1\\) ist skalenkohÃ¤rent; Abweichungen erhÃ¶hen den â€žSkalenâ€‘Straftermâ€œ.\n\n---\n\n## Zusammenfassung (in Prosa)\nEin belastbares Interpolationsâ€‘Setup entsteht **von der Skala her**: Wir schÃ¤tzen \\(L_{50}, L_{95}\\) und \\(\\sigma_{\\text{proc}}\\) aus dem Variogramm, glÃ¤tten die Drift mit Radien \\(R\\) auf passende Skalen und tunen \\(R\\) via blockierter Uâ€‘Kurve zum \\(R^*\\). Die Bewertung erfolgt mit rÃ¤umlich sinnvollen BlÃ¶cken (\\(\\approx L_{95}\\) oder \\(R^*\\)), und das Fehlerbudget trennt Messrauschen, Skalenâ€‘Mismatch (quantifiziert durch \\(g(R/L)\\)) und Modellâ€‘Rest. Erst wenn diese Schritte **skalenkohÃ¤rent** sind, sind RMSE/MAE/Bias **interpretierbar** und die beste Methode (KED/OK/GAM/RF/Trend/â€¦) fachlich begrÃ¼ndet.\n\n---\n\n## Kurzâ€‘Literatur\n- Cressie, N. (1993). *Statistics for Spatial Data*. Wiley.  \n- ChilÃ¨s, J.â€‘P., & Delfiner, P. (2012). *Geostatistics: Modeling Spatial Uncertainty* (2nd ed.). Wiley.  \n- Goovaerts, P. (1997). *Geostatistics for Natural Resources Evaluation*. Oxford.  \n- Wackernagel, H. (2003). *Multivariate Geostatistics* (3rd ed.). Springer.  \n- Hengl, T. (2009). *A Practical Guide to Geostatistical Mapping*. OpenGeoHub.  \n- Roberts, D. R. etâ€¯al. (2017). Crossâ€‘validation strategies for data with spatial structure. *Ecography*, 40, 913â€“929.\nKurzcheck (gegen dein Glossar):\n\n# Appendix: Glossary\n\n* **L50 / L95** â€” practical correlation lengths from the variogram (50% / 95% of sill).\n* **R (micro/local)** â€” chosen smoothing radii (â‰ˆ L50 / L95).\n* **R**\\* â€” tuned drift radius from block-CV (U-curve minimum).\n* **Block size** â€” CV block edge length (â‰ˆ L95 or R\\*).\n* **RMSE / MAE / Bias** â€” standard errors on held-out blocks.\n* **Ïƒ\\_proc** â€” process SD from the variogram (âˆš structural sill).\n* **Ïƒ\\_inst** â€” assumed sensor noise SD in the error budget.\n* **g(R/L)** â€” penalty for scale mismatch; minimal at R/L = 1.\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}